---
import i18next, { t } from "i18next";
---

<div class="relative" x-data="{ open: false }">
  <button
    @click="open = !open; if(open) $nextTick(() => $refs.searchInput.focus())"
    class="flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-full transition-all"
    :class="open ? 'bg-gray-200' : 'hover:bg-gray-100'"
    type="button"
    :aria-label="open ? t('closeSearch') : t('toggleSearch')"
    :aria-expanded="open"
  >
    <span class="text-black">{t("search")}</span>
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="20"
      height="20"
      viewBox="0 0 1024 1024"
      class="transition-transform duration-200"
      :class="{'rotate-90': open}"
    >
      <path
        fill="currentColor"
        d="M1014.64 969.04L703.71 656.207c57.952-69.408 92.88-158.704 92.88-256.208c0-220.912-179.088-400-400-400s-400 179.088-400 400s179.088 400 400 400c100.368 0 192.048-37.056 262.288-98.144l310.496 312.448c12.496 12.497 32.769 12.497 45.265 0c12.48-12.496 12.48-32.752 0-45.263zM396.59 736.527c-185.856 0-336.528-150.672-336.528-336.528S210.734 63.471 396.59 63.471s336.528 150.672 336.528 336.528S582.446 736.527 396.59 736.527"
      ></path>
    </svg>
  </button>

  <input
    x-ref="searchInput"
    type="text"
    :placeholder="t('searchPlaceholder')"
    x-show="open"
    @keydown.escape="open = false"
    @click.outside="open = false"
    class="absolute right-0 top-full mt-2 px-4 py-2 text-sm border border-gray-300 rounded-full outline-none bg-white shadow-sm transition-all duration-300 w-64"
    x-transition:enter="transition ease-out duration-100"
    x-transition:enter-start="opacity-0 scale-95"
    x-transition:enter-end="opacity-100 scale-100"
    x-transition:leave="transition ease-in duration-75"
    x-transition:leave-start="opacity-100 scale-100"
    x-transition:leave-end="opacity-0 scale-95"
  />
</div>
